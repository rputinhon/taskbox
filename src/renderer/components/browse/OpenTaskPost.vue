<template>
  <v-card hover v-bind="post" max-height="500px" @click="openPost()">
    <v-card-title>
      <v-tooltip bottom transition="none">
        <template v-slot:activator="{ on }">
          <v-avatar v-on="on" color="grey" size="27" class="mr-3" @click.stop="goToProfile(post.member)">
            <v-img v-if="member" :src="member.profilePicture" />
            <svg v-else version="1.1" viewBox="0 0 10.583 10.583" xmlns="http://www.w3.org/2000/svg">
              <path transform="scale(.26458)" d="m20 2.5625a17.437 17.437 0 0 0-17.438 17.438 17.437 17.437 0 0 0 4.8223 12.031v-4.2383c0-2.915 2.3467-5.2617 5.2617-5.2617h3.9492v-0.66602a7.6903 7.6903 0 0 1-4.2871-6.8887 7.6903 7.6903 0 0 1 7.6895-7.6914 7.6903 7.6903 0 0 1 7.6914 7.6914 7.6903 7.6903 0 0 1-4.7539 7.0996v0.45508h4.416c2.915 0 5.2617 2.3467 5.2617 5.2617v4.2402a17.437 17.437 0 0 0 4.8242-12.033 17.437 17.437 0 0 0-17.438-17.438z" fill="#fafafa" stop-color="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="4.1284" style="-inkscape-stroke: none; font-variation-settings: normal; paint-order: fill markers stroke" />
            </svg>
          </v-avatar>
        </template>
        go to profile
      </v-tooltip>
      <div>{{ post.title }}</div>
      <v-spacer></v-spacer>
      <v-btn fab small icon>
        <svg style="pointer-events: none" width="40" version="1.1" viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
          <path v-if="false" d="m 34.834764,10.957157 -15.096,15.48 -7.1044,-7.0832 c -0.45412,-0.45156 -1.186,-0.45694 -1.6467,-0.01209 l -3.9441987,3.8019 c -0.47251,0.45664 -0.47936,1.2118 -0.01519,1.6769 l 11.8869987,11.884 c 0.46077,0.46136 1.2088,0.45996 1.6679,-0.0031 l 20.015,-20.151 c 0.46337,-0.46596 0.45519,-1.2212 -0.01816,-1.6769 l -4.0895,-3.9412 c -0.570667,-0.503799 -1.192459,-0.455738 -1.655752,0.02469 z" fill="#0187f3" />
          <path
            v-else
            d="m 35.589844,9.5800781 c -0.573351,0.018314 -1.09936,0.2964182 -1.47461,0.6855469 L 19.728516,25.017578 13.339844,18.648437 C 12.507606,17.820892 11.137271,17.809745 10.292969,18.625 l -3.9433596,3.802734 h -0.00195 c -0.8651932,0.836135 -0.8773048,2.249903 -0.027344,3.101563 v 0.002 L 18.208984,37.416016 c 0.844091,0.843029 2.243864,0.839554 3.083985,-0.0078 l 20.013672,-20.148437 0.002,-0.002 c 0.846531,-0.853423 0.831086,-2.267619 -0.03516,-3.101562 l -4.105468,-3.955078 -0.01563,-0.01563 c -0.432247,-0.3815986 -0.98915,-0.6237833 -1.5625,-0.6054689 z m 0.06445,1.9980469 c -0.0039,1.25e-4 0.03782,-0.01158 0.171875,0.105469 0.0018,0.0016 1.32e-4,3.45e-4 0.002,0.002 l 4.058594,3.912109 c 0.0798,0.07683 0.08021,0.171302 0.002,0.25 v 0.002 L 19.873047,36 c -0.07744,0.07811 -0.172347,0.07971 -0.25,0.002 V 36 L 7.7363281,24.117187 c -0.077774,-0.07793 -0.076039,-0.173169 0.00195,-0.25 l 3.9433598,-3.802734 c 0.0771,-0.07444 0.172045,-0.07362 0.248047,0.002 l 7.818359,7.796875 15.804687,-16.207031 0.002,-0.002 c 0.08804,-0.0913 0.103575,-0.0763 0.09961,-0.07617 z"
            fill="#0187f3"
          />
        </svg>
      </v-btn>
    </v-card-title>
    <v-card flat color="grey" rounded="0" height="256" class="my-auto">
      <v-img height="256" v-if="post.image" :src="post.image" />
      <svg v-else style="max-height: 256px" version="1.1" viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">
        <path
          d="m 35.589844,9.5800781 c -0.573351,0.018314 -1.09936,0.2964182 -1.47461,0.6855469 L 19.728516,25.017578 13.339844,18.648437 C 12.507606,17.820892 11.137271,17.809745 10.292969,18.625 l -3.9433596,3.802734 h -0.00195 c -0.8651932,0.836135 -0.8773048,2.249903 -0.027344,3.101563 v 0.002 L 18.208984,37.416016 c 0.844091,0.843029 2.243864,0.839554 3.083985,-0.0078 l 20.013672,-20.148437 0.002,-0.002 c 0.846531,-0.853423 0.831086,-2.267619 -0.03516,-3.101562 l -4.105468,-3.955078 -0.01563,-0.01563 c -0.432247,-0.3815986 -0.98915,-0.6237833 -1.5625,-0.6054689 z m 0.06445,1.9980469 c -0.0039,1.25e-4 0.03782,-0.01158 0.171875,0.105469 0.0018,0.0016 1.32e-4,3.45e-4 0.002,0.002 l 4.058594,3.912109 c 0.0798,0.07683 0.08021,0.171302 0.002,0.25 v 0.002 L 19.873047,36 c -0.07744,0.07811 -0.172347,0.07971 -0.25,0.002 V 36 L 7.7363281,24.117187 c -0.077774,-0.07793 -0.076039,-0.173169 0.00195,-0.25 l 3.9433598,-3.802734 c 0.0771,-0.07444 0.172045,-0.07362 0.248047,0.002 l 7.818359,7.796875 15.804687,-16.207031 0.002,-0.002 c 0.08804,-0.0913 0.103575,-0.0763 0.09961,-0.07617 z"
          fill="#fafafa"
        />
      </svg>
    </v-card>

    <v-card-text>
      <div class="mb-7 text-subtitle-1">
        <!-- <v-list-item>
          <v-list-item-icon class="mx-2">
            <svg width="28" version="1.1" viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">
              <path
                d="m 35.589844,9.5800781 c -0.573351,0.018314 -1.09936,0.2964182 -1.47461,0.6855469 L 19.728516,25.017578 13.339844,18.648437 C 12.507606,17.820892 11.137271,17.809745 10.292969,18.625 l -3.9433596,3.802734 h -0.00195 c -0.8651932,0.836135 -0.8773048,2.249903 -0.027344,3.101563 v 0.002 L 18.208984,37.416016 c 0.844091,0.843029 2.243864,0.839554 3.083985,-0.0078 l 20.013672,-20.148437 0.002,-0.002 c 0.846531,-0.853423 0.831086,-2.267619 -0.03516,-3.101562 l -4.105468,-3.955078 -0.01563,-0.01563 c -0.432247,-0.3815986 -0.98915,-0.6237833 -1.5625,-0.6054689 z m 0.06445,1.9980469 c -0.0039,1.25e-4 0.03782,-0.01158 0.171875,0.105469 0.0018,0.0016 1.32e-4,3.45e-4 0.002,0.002 l 4.058594,3.912109 c 0.0798,0.07683 0.08021,0.171302 0.002,0.25 v 0.002 L 19.873047,36 c -0.07744,0.07811 -0.172347,0.07971 -0.25,0.002 V 36 L 7.7363281,24.117187 c -0.077774,-0.07793 -0.076039,-0.173169 0.00195,-0.25 l 3.9433598,-3.802734 c 0.0771,-0.07444 0.172045,-0.07362 0.248047,0.002 l 7.818359,7.796875 15.804687,-16.207031 0.002,-0.002 c 0.08804,-0.0913 0.103575,-0.0763 0.09961,-0.07617 z"
                fill="grey"
              />
            </svg>
          </v-list-item-icon>
          <v-list-item-subtitle class="text-left">
            {{ post.subject }}
          </v-list-item-subtitle>
        </v-list-item> -->
        {{ post.fullDescription }}
      </div>
      <v-row align="center" justify="center" class="mx-auto my-1">
        <svg width="25" version="1.1" viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">
          <path
            d="m 15.799846,15.472064 c -4.691982,0 -8.5338938,3.841912 -8.5338938,8.533895 v 0.0024 c 0.00219,1.754435 0.5627167,3.410711 1.5163438,4.801357 -3.6742287,1.070006 -6.4272008,4.336342 -6.4272008,8.345839 v 2.499468 c 1.012e-4,1.009635 0.8185463,1.82808 1.8281816,1.828182 H 27.064112 c 1.009635,-1.02e-4 1.82808,-0.818547 1.828181,-1.828182 v -2.499468 c 0,-3.903169 -2.601925,-7.122957 -6.127265,-8.283948 0.982787,-1.404003 1.566434,-3.080197 1.568713,-4.863248 v -0.0024 c 0,-4.691983 -3.841912,-8.533895 -8.533895,-8.533895 z m 0,3.656364 c 2.715126,0 4.876234,2.160358 4.877532,4.87515 -0.0024,1.946412 -1.149412,3.695969 -2.935089,4.470476 -1.813196,0.791537 -1.252392,3.498107 0.726036,3.504015 h 1.592518 c 2.898623,0 5.175087,2.278293 5.175087,5.177466 v 0.671286 H 6.0114583 v -0.671286 c 0,-2.899173 2.276462,-5.177466 5.1750867,-5.177466 h 1.944823 c 1.979735,-0.0033 2.5428,-2.711944 0.728416,-3.504015 -1.784948,-0.774191 -2.93405,-2.522646 -2.937469,-4.468095 v -0.0024 c 0.0013,-2.714792 2.162408,-4.875151 4.877531,-4.875151 z M 32.552465,6.5167582 c -4.691983,0 -8.533894,3.8419118 -8.533894,8.5338938 v 0.0024 c 0.0022,1.754435 0.562715,3.41071 1.516342,4.801357 -0.350673,0.102122 -0.688913,0.230476 -1.02121,0.371349 0.356126,1.002958 0.552263,2.078543 0.552263,3.199317 v 0.0024 c -1.89e-4,0.15345 -0.01133,0.305013 -0.01905,0.457045 0.821177,-0.545753 1.813396,-0.86172 2.89224,-0.86172 h 1.944823 c 1.979736,-0.0033 2.5428,-2.711944 0.728416,-3.504015 -1.784947,-0.774191 -2.93405,-2.522643 -2.937468,-4.468095 v -0.0024 c 0.0013,-2.714792 2.162407,-4.875151 4.877531,-4.875151 2.715125,0 4.876233,2.160359 4.877531,4.875151 -0.0024,1.946412 -1.149412,3.695969 -2.935088,4.470476 -1.813197,0.791537 -1.252392,3.498107 0.726035,3.504014 h 1.592518 c 2.898624,0 5.175086,2.278295 5.175086,5.177468 V 28.87157 H 24.704133 c 1.798049,0.972797 2.691769,1.930582 3.984864,3.656363 h 15.127726 c 1.009635,-1.01e-4 1.82808,-0.818546 1.828181,-1.828181 v -2.499467 c 0,-3.903169 -2.601925,-7.122957 -6.127264,-8.283948 0.982787,-1.404003 1.566434,-3.080197 1.568713,-4.863248 v -0.0024 c 0,-4.691982 -3.841911,-8.5338938 -8.533894,-8.5338938 z"
            fill="grey"
          />
        </svg>
        <div class="grey--text ms-4">{{ post.interesteds.length }} candidats</div>
        <v-spacer> </v-spacer>
        <v-btn color="primary" outlined x-small> accept </v-btn>
      </v-row>

      <!-- <v-rating :value="4.5" color="amber" dense half-increments readonly size="18"></v-rating> -->
    </v-card-text>
  </v-card>
</template>

<script>
import { eventBus } from '../../../main';
import { memberRepository } from '../../store/modules/user/profileRepository';
export default {
  name: 'OpenTaskPost',
  props: { post: Object },
  data() {
    return {
      member: null,
    };
  },
  mounted() {
    this.getMember(this.post.member);
  },
  methods: {
    openPost() {
      this.$store.commit('post/PREVIEW_POST', this.post);
    },
    goToProfile(id) {
      eventBus.$emit('showProfile', id);
    },
    async getMember(id) {
      memberRepository.get(id, ['_id', 'data.id', 'data.username', 'data.profilePicture']).then((member) => {
        this.member = member;
      });
    },
  },
};
</script>
